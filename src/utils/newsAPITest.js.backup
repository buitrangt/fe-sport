// File nÃ y Ä‘á»ƒ test News API trá»±c tiáº¿p tá»« browser console
// Sá»­ dá»¥ng: import('./newsAPITest.js').then(module => module.testNewsAPI())

import newsService from '../services/newsService';

// Test cÆ¡ báº£n Ä‘á»ƒ kiá»ƒm tra API
export const testNewsAPI = async () => {
  console.log('ğŸš€ Starting News API Tests...');
  
  try {
    // Test 1: getAllNews
    console.log('ğŸ“° Test 1: getAllNews');
    const allNews = await newsService.getAllNews();
    console.log('âœ… getAllNews result:', allNews);
    console.log('âœ… Type:', typeof allNews);
    console.log('âœ… Is Array:', Array.isArray(allNews));
    
    if (Array.isArray(allNews) && allNews.length > 0) {
      console.log('âœ… Sample news item:', allNews[0]);
      console.log('âœ… Available fields:', Object.keys(allNews[0]));
      
      // Test 2: getNewsById
      console.log('ğŸ“– Test 2: getNewsById');
      const singleNews = await newsService.getNewsById(allNews[0].id);
      console.log('âœ… getNewsById result:', singleNews);
    }
    
    return { success: true, data: allNews };
  } catch (error) {
    console.error('âŒ API Test failed:', error);
    return { success: false, error };
  }
};

// Test táº¡o tin tá»©c (cáº©n tháº­n vá»›i viá»‡c nÃ y)
export const testCreateNews = async () => {
  console.log('ğŸš€ Testing createNews...');
  
  const testData = {
    name: `Test News - ${new Date().toISOString()}`,
    shortDescription: 'This is a test news article',
    content: 'This is the content of the test news article. It contains more detailed information.'
  };
  
  try {
    const result = await newsService.createNews(testData);
    console.log('âœ… createNews success:', result);
    
    // Cleanup - delete the test news
    if (result.id) {
      console.log('ğŸ—‘ï¸ Cleaning up test news...');
      await newsService.deleteNews(result.id);
      console.log('âœ… Test news cleaned up');
    }
    
    return { success: true, data: result };
  } catch (error) {
    console.error('âŒ createNews failed:', error);
    return { success: false, error };
  }
};

// Test update tin tá»©c
export const testUpdateNews = async (newsId, newData) => {
  console.log('ğŸš€ Testing updateNews...');
  
  try {
    const result = await newsService.updateNews(newsId, newData);
    console.log('âœ… updateNews success:', result);
    return { success: true, data: result };
  } catch (error) {
    console.error('âŒ updateNews failed:', error);
    return { success: false, error };
  }
};

// Test delete tin tá»©c (cáº©n tháº­n!)
export const testDeleteNews = async (newsId) => {
  console.log('ğŸš€ Testing deleteNews...');
  console.log('âš ï¸ Warning: This will permanently delete the news article!');
  
  try {
    const result = await newsService.deleteNews(newsId);
    console.log('âœ… deleteNews success:', result);
    return { success: true, data: result };
  } catch (error) {
    console.error('âŒ deleteNews failed:', error);
    return { success: false, error };
  }
};

// Cháº¡y táº¥t cáº£ tests an toÃ n
export const runSafeTests = async () => {
  console.log('ğŸ›¡ï¸ Running safe tests only...');
  
  const results = {
    getAllNews: await testNewsAPI(),
    createAndDeleteTest: await testCreateNews()
  };
  
  console.log('ğŸ“‹ Test Results:', results);
  return results;
};

// Export Ä‘á»ƒ cÃ³ thá»ƒ sá»­ dá»¥ng tá»« browser console
if (typeof window !== 'undefined') {
  window.newsAPITests = {
    testNewsAPI,
    testCreateNews,
    testUpdateNews,
    testDeleteNews,
    runSafeTests
  };
  
  console.log('ğŸ“ News API Tests loaded! Available functions:');
  console.log('   - window.newsAPITests.testNewsAPI()');
  console.log('   - window.newsAPITests.testCreateNews()');
  console.log('   - window.newsAPITests.runSafeTests()');
}

export default {
  testNewsAPI,
  testCreateNews,
  testUpdateNews,
  testDeleteNews,
  runSafeTests
};